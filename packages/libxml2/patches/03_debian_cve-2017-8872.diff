From d1ca21cf7b8b7360e238f4a32b58ca97d7276504 Mon Sep 17 00:00:00 2001
From: Salvatore Bonaccorso <carnil@debian.org>
Date: Tue, 2 Jan 2018 13:19:04 +0100
Subject: [PATCH] Out-of-bounds read in htmlParseTryOrFinish (CVE-2017-8872)

Fixes bug 775200.

diff -ur libxml2-2.9.10.orig/parser.c libxml2-2.9.10/parser.c
--- libxml2-2.9.10.orig/parser.c	2019-12-08 04:03:56.571076330 +0100
+++ libxml2-2.9.10/parser.c	2019-12-08 04:04:09.843144289 +0100
@@ -12508,6 +12508,10 @@
         ctxt->input->length = 0;
 	ctxt->input->base = ctxt->input->cur;
         ctxt->input->end = ctxt->input->cur;
+    if (ctxt->input->buf)
+        xmlBufEmpty (ctxt->input->buf->buffer);
+    else
+        ctxt->input->length = 0;
     }
 }
 
