diff -ur libxml2-2.9.4.orig/parser.c libxml2-2.9.4/parser.c
--- libxml2-2.9.4.orig/parser.c	2016-05-23 09:25:25.000000000 +0200
+++ libxml2-2.9.4/parser.c	2016-07-03 06:52:49.598294351 +0200
@@ -1324,7 +1324,7 @@
         return;
 
     xmlHashAddEntry2(ctxt->attsSpecial, fullname, fullattr,
-                     (void *) (long) type);
+                     (void *) (intptr_t) type);
     return;
 
 mem_error:
@@ -1343,7 +1343,7 @@
                             const xmlChar *unused ATTRIBUTE_UNUSED) {
     xmlParserCtxtPtr ctxt = (xmlParserCtxtPtr) data;
 
-    if (((long) payload) == XML_ATTRIBUTE_CDATA) {
+    if (((intptr_t) payload) == XML_ATTRIBUTE_CDATA) {
         xmlHashRemoveEntry2(ctxt->attsSpecial, fullname, fullattr, NULL);
     }
 }
@@ -1855,7 +1855,7 @@
     ctxt->name = value;
     ctxt->pushTab[ctxt->nameNr * 3] = (void *) prefix;
     ctxt->pushTab[ctxt->nameNr * 3 + 1] = (void *) URI;
-    ctxt->pushTab[ctxt->nameNr * 3 + 2] = (void *) (long) nsNr;
+    ctxt->pushTab[ctxt->nameNr * 3 + 2] = (void *) (intptr_t) nsNr;
     return (ctxt->nameNr++);
 mem_error:
     xmlErrMemory(ctxt, NULL);
@@ -9259,7 +9259,7 @@
     if (ctxt->attsSpecial != NULL) {
         int type;
 
-        type = (int) (long) xmlHashQLookup2(ctxt->attsSpecial,
+        type = (int) (intptr_t) xmlHashQLookup2(ctxt->attsSpecial,
                                             pref, elem, *prefix, name);
         if (type != 0)
             normalize = 1;
@@ -11785,7 +11785,7 @@
 		    xmlParseEndTag2(ctxt,
 		           (void *) ctxt->pushTab[ctxt->nameNr * 3 - 3],
 		           (void *) ctxt->pushTab[ctxt->nameNr * 3 - 2], 0,
-		       (int) (long) ctxt->pushTab[ctxt->nameNr * 3 - 1], 0);
+		       (int) (intptr_t) ctxt->pushTab[ctxt->nameNr * 3 - 1], 0);
 		    nameNsPop(ctxt);
 		}
 #ifdef LIBXML_SAX1_ENABLED
diff -ur libxml2-2.9.4.orig/relaxng.c libxml2-2.9.4/relaxng.c
--- libxml2-2.9.4.orig/relaxng.c	2016-05-23 09:25:25.000000000 +0200
+++ libxml2-2.9.4/relaxng.c	2016-07-03 06:52:49.602294324 +0200
@@ -4403,7 +4403,7 @@
                 if ((*tmp)->type == XML_RELAXNG_TEXT) {
                     res = xmlHashAddEntry2(partitions->triage,
                                            BAD_CAST "#text", NULL,
-                                           (void *) (long) (i + 1));
+                                           (void *) (intptr_t) (i + 1));
                     if (res != 0)
                         is_determinist = -1;
                 } else if (((*tmp)->type == XML_RELAXNG_ELEMENT) &&
@@ -4411,22 +4411,22 @@
                     if (((*tmp)->ns == NULL) || ((*tmp)->ns[0] == 0))
                         res = xmlHashAddEntry2(partitions->triage,
                                                (*tmp)->name, NULL,
-                                               (void *) (long) (i + 1));
+                                               (void *) (intptr_t) (i + 1));
                     else
                         res = xmlHashAddEntry2(partitions->triage,
                                                (*tmp)->name, (*tmp)->ns,
-                                               (void *) (long) (i + 1));
+                                               (void *) (intptr_t) (i + 1));
                     if (res != 0)
                         is_determinist = -1;
                 } else if ((*tmp)->type == XML_RELAXNG_ELEMENT) {
                     if (((*tmp)->ns == NULL) || ((*tmp)->ns[0] == 0))
                         res = xmlHashAddEntry2(partitions->triage,
                                                BAD_CAST "#any", NULL,
-                                               (void *) (long) (i + 1));
+                                               (void *) (intptr_t) (i + 1));
                     else
                         res = xmlHashAddEntry2(partitions->triage,
                                                BAD_CAST "#any", (*tmp)->ns,
-                                               (void *) (long) (i + 1));
+                                               (void *) (intptr_t) (i + 1));
                     if ((*tmp)->nameClass != NULL)
                         is_determinist = 2;
                     if (res != 0)
@@ -9386,7 +9386,7 @@
             if (tmp == NULL) {
                 i = nbgroups;
             } else {
-                i = ((long) tmp) - 1;
+                i = ((intptr_t) tmp) - 1;
                 if (partitions->flags & IS_NEEDCHECK) {
                     group = partitions->groups[i];
                     if (!xmlRelaxNGNodeMatchesList(cur, group->defs))
diff -ur libxml2-2.9.4.orig/SAX2.c libxml2-2.9.4/SAX2.c
--- libxml2-2.9.4.orig/SAX2.c	2016-05-23 09:25:25.000000000 +0200
+++ libxml2-2.9.4/SAX2.c	2016-07-03 06:52:49.606294296 +0200
@@ -1908,7 +1908,7 @@
 	    else {
 	        ret->line = 65535;
 		if (ctxt->options & XML_PARSE_BIG_LINES)
-		    ret->psvi = (void *) (long) ctxt->input->line;
+		    ret->psvi = (void *) (intptr_t) ctxt->input->line;
 	    }
 	}
     }
diff -ur libxml2-2.9.4.orig/tree.c libxml2-2.9.4/tree.c
--- libxml2-2.9.4.orig/tree.c	2016-05-23 09:25:25.000000000 +0200
+++ libxml2-2.9.4/tree.c	2016-07-03 06:52:49.610294268 +0200
@@ -4596,7 +4596,7 @@
 	(node->type == XML_PI_NODE)) {
 	if (node->line == 65535) {
 	    if ((node->type == XML_TEXT_NODE) && (node->psvi != NULL))
-	        result = (long) node->psvi;
+	        result = (intptr_t) node->psvi;
 	    else if ((node->type == XML_ELEMENT_NODE) &&
 	             (node->children != NULL))
 	        result = xmlGetLineNoInternal(node->children, depth + 1);
diff -ur libxml2-2.9.4.orig/xmlIO.c libxml2-2.9.4/xmlIO.c
--- libxml2-2.9.4.orig/xmlIO.c	2016-05-23 09:25:25.000000000 +0200
+++ libxml2-2.9.4/xmlIO.c	2016-07-03 06:52:49.610294268 +0200
@@ -826,7 +826,7 @@
 xmlFdRead (void * context, char * buffer, int len) {
     int ret;
 
-    ret = read((int) (long) context, &buffer[0], len);
+    ret = read((int) (intptr_t) context, &buffer[0], len);
     if (ret < 0) xmlIOErr(0, "read()");
     return(ret);
 }
@@ -847,7 +847,7 @@
     int ret = 0;
 
     if (len > 0) {
-	ret = write((int) (long) context, &buffer[0], len);
+	ret = write((int) (intptr_t) context, &buffer[0], len);
 	if (ret < 0) xmlIOErr(0, "write()");
     }
     return(ret);
@@ -865,7 +865,7 @@
 static int
 xmlFdClose (void * context) {
     int ret;
-    ret = close((int) (long) context);
+    ret = close((int) (intptr_t) context);
     if (ret < 0) xmlIOErr(0, "close()");
     return(ret);
 }
@@ -3003,7 +3003,7 @@
 
     ret = xmlAllocParserInputBuffer(enc);
     if (ret != NULL) {
-        ret->context = (void *) (long) fd;
+        ret->context = (void *) (intptr_t) fd;
 	ret->readcallback = xmlFdRead;
 	ret->closecallback = xmlFdClose;
     }
@@ -3109,7 +3109,7 @@
 
     ret = xmlAllocOutputBufferInternal(encoder);
     if (ret != NULL) {
-        ret->context = (void *) (long) fd;
+        ret->context = (void *) (intptr_t) fd;
 	ret->writecallback = xmlFdWrite;
 	ret->closecallback = NULL;
     }
diff -ur libxml2-2.9.4.orig/xmlmemory.c libxml2-2.9.4/xmlmemory.c
--- libxml2-2.9.4.orig/xmlmemory.c	2016-05-23 09:01:06.000000000 +0200
+++ libxml2-2.9.4/xmlmemory.c	2016-07-03 06:52:49.610294268 +0200
@@ -473,7 +473,7 @@
 
 error:
     xmlGenericError(xmlGenericErrorContext,
-	    "xmlMemFree(%lX) error\n", (unsigned long) ptr);
+	    "xmlMemFree(%lX) error\n", (uintptr_t) ptr);
     xmlMallocBreakpoint();
     return;
 }
diff -ur libxml2-2.9.4.orig/xpath.c libxml2-2.9.4/xpath.c
--- libxml2-2.9.4.orig/xpath.c	2016-05-23 09:25:25.000000000 +0200
+++ libxml2-2.9.4/xpath.c	2016-07-03 06:52:49.618294213 +0200
@@ -167,12 +167,12 @@
     switch (node1->type) {
 	case XML_ELEMENT_NODE:
 	    if (node2->type == XML_ELEMENT_NODE) {
-		if ((0 > (long) node1->content) && /* TODO: Would a != 0 suffice here? */
-		    (0 > (long) node2->content) &&
+		if ((0 > (intptr_t) node1->content) && /* TODO: Would a != 0 suffice here? */
+		    (0 > (intptr_t) node2->content) &&
 		    (node1->doc == node2->doc))
 		{
-		    l1 = -((long) node1->content);
-		    l2 = -((long) node2->content);
+		    l1 = -((intptr_t) node1->content);
+		    l2 = -((intptr_t) node2->content);
 		    if (l1 < l2)
 			return(1);
 		    if (l1 > l2)
@@ -217,7 +217,7 @@
 		node1 = node1->parent;
 	    }
 	    if ((node1 == NULL) || (node1->type != XML_ELEMENT_NODE) ||
-		(0 <= (long) node1->content)) {
+		(0 <= (intptr_t) node1->content)) {
 		/*
 		* Fallback for whatever case.
 		*/
@@ -267,7 +267,7 @@
 		node2 = node2->parent;
 	    }
 	    if ((node2 == NULL) || (node2->type != XML_ELEMENT_NODE) ||
-		(0 <= (long) node2->content))
+		(0 <= (intptr_t) node2->content))
 	    {
 		node2 = miscNode2;
 		precedence2 = 0;
@@ -340,12 +340,12 @@
      */
     if ((node1->type == XML_ELEMENT_NODE) &&
 	(node2->type == XML_ELEMENT_NODE) &&
-	(0 > (long) node1->content) &&
-	(0 > (long) node2->content) &&
+	(0 > (intptr_t) node1->content) &&
+	(0 > (intptr_t) node2->content) &&
 	(node1->doc == node2->doc)) {
 
-	l1 = -((long) node1->content);
-	l2 = -((long) node2->content);
+	l1 = -((intptr_t) node1->content);
+	l2 = -((intptr_t) node2->content);
 	if (l1 < l2)
 	    return(1);
 	if (l1 > l2)
@@ -408,12 +408,12 @@
      */
     if ((node1->type == XML_ELEMENT_NODE) &&
 	(node2->type == XML_ELEMENT_NODE) &&
-	(0 > (long) node1->content) &&
-	(0 > (long) node2->content) &&
+	(0 > (intptr_t) node1->content) &&
+	(0 > (intptr_t) node2->content) &&
 	(node1->doc == node2->doc)) {
 
-	l1 = -((long) node1->content);
-	l2 = -((long) node2->content);
+	l1 = -((intptr_t) node1->content);
+	l2 = -((intptr_t) node2->content);
 	if (l1 < l2)
 	    return(1);
 	if (l1 > l2)
@@ -3233,7 +3233,7 @@
     cur = doc->children;
     while (cur != NULL) {
 	if (cur->type == XML_ELEMENT_NODE) {
-	    cur->content = (void *) (-(++count));
+	    cur->content = (void *) (intptr_t) (-(++count));
 	    if (cur->children != NULL) {
 		cur = cur->children;
 		continue;
@@ -3325,13 +3325,13 @@
      */
     if ((node1->type == XML_ELEMENT_NODE) &&
 	(node2->type == XML_ELEMENT_NODE) &&
-	(0 > (long) node1->content) &&
-	(0 > (long) node2->content) &&
+	(0 > (intptr_t) node1->content) &&
+	(0 > (intptr_t) node2->content) &&
 	(node1->doc == node2->doc)) {
 	long l1, l2;
 
-	l1 = -((long) node1->content);
-	l2 = -((long) node2->content);
+	l1 = -((intptr_t) node1->content);
+	l2 = -((intptr_t) node2->content);
 	if (l1 < l2)
 	    return(1);
 	if (l1 > l2)
@@ -3388,13 +3388,13 @@
      */
     if ((node1->type == XML_ELEMENT_NODE) &&
 	(node2->type == XML_ELEMENT_NODE) &&
-	(0 > (long) node1->content) &&
-	(0 > (long) node2->content) &&
+	(0 > (intptr_t) node1->content) &&
+	(0 > (intptr_t) node2->content) &&
 	(node1->doc == node2->doc)) {
 	long l1, l2;
 
-	l1 = -((long) node1->content);
-	l2 = -((long) node2->content);
+	l1 = -((intptr_t) node1->content);
+	l2 = -((intptr_t) node2->content);
 	if (l1 < l2)
 	    return(1);
 	if (l1 > l2)
