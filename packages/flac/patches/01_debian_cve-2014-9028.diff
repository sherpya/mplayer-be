diff -ur flac-1.3.4.orig/src/libFLAC/stream_decoder.c flac-1.3.4/src/libFLAC/stream_decoder.c
--- flac-1.3.4.orig/src/libFLAC/stream_decoder.c	2022-02-14 06:21:14.030609824 +0100
+++ flac-1.3.4/src/libFLAC/stream_decoder.c	2022-02-28 02:45:59.795886308 +0100
@@ -2396,7 +2396,8 @@
 			decoder->private_->cached = true;
 			send_error_to_client_(decoder, FLAC__STREAM_DECODER_ERROR_STATUS_BAD_HEADER);
 			decoder->protected_->state = FLAC__STREAM_DECODER_SEARCH_FOR_FRAME_SYNC;
-			return true;
+			/* We have received a potentially malicious bt stream. All we can do is error out to avoid a heap overflow. */
+			return false;
 		}
 		decoder->private_->frame.header.number_type = FLAC__FRAME_NUMBER_TYPE_FRAME_NUMBER;
 		decoder->private_->frame.header.number.frame_number = x;
